# Optimized Apache configuration for MediaWiki
ServerName adnd2e
TimeOut 300
KeepAlive On
MaxKeepAliveRequests 100
KeepAliveTimeout 5

# Important for working with Traefik
RemoteIPHeader X-Forwarded-For
RequestHeader set X-Forwarded-Proto "https" env=HTTPS

# Enable compression for text content
AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css text/javascript application/javascript
BrowserMatch ^Mozilla/4 gzip-only-text/html
BrowserMatch ^Mozilla/4\.0[678] no-gzip
BrowserMatch \bMSIE !no-gzip !gzip-only-text/html

# Cache control for static assets
<FilesMatch "\.(ico|pdf|flv|jpg|jpeg|png|gif|js|css|swf)$">
Header set Cache-Control "max-age=604800, public"
</FilesMatch>

# Security settings
Header always set X-Content-Type-Options "nosniff"
Header always set X-XSS-Protection "1; mode=block"
Header always set X-Frame-Options "SAMEORIGIN"

# Optimize proxy settings
ProxyIOBufferSize 65536
ProxyTimeout 120
