# Add these sections at the top of your my.cnf file
[client]
default-character-set = utf8mb4

[mysql]
default-character-set = utf8mb4

# Then add these lines to your existing [mysqld] section
# Character set and collation settings
character-set-server = utf8mb4
collation-server = utf8mb4_unicode_ci
character_set_client = utf8mb4
character_set_connection = utf8mb4
character_set_results = utf8mb4
character_set_filesystem = binary
character_set_system = utf8
character_set_database = utf8mb4
skip-character-set-client-handshake
init_connect='SET NAMES utf8mb4'
[mysqld]
# Connection settings
wait_timeout = 28800
interactive_timeout = 28800
max_allowed_packet = 64M
connect_timeout = 10
net_read_timeout = 30
net_write_timeout = 30

# InnoDB settings optimized for 20 CPUs and 12GB container memory
innodb_buffer_pool_size = 10G
innodb_log_file_size = 1G
innodb_flush_log_at_trx_commit = 2
innodb_flush_method = O_DIRECT
innodb_file_per_table = 1
innodb_stats_on_metadata = 0

# I/O threads optimized for 20 CPUs
innodb_read_io_threads = 8
innodb_write_io_threads = 8
innodb_io_capacity = 4000
innodb_io_capacity_max = 8000

# Performance optimizations
innodb_flush_neighbors = 0
innodb_random_read_ahead = 0
innodb_read_ahead_threshold = 0
innodb_adaptive_hash_index = 0
innodb_change_buffering = none
innodb_checksum_algorithm = crc32
innodb_compression_level = 6
innodb_compression_failure_threshold_pct = 5
innodb_deadlock_detect = 1
innodb_disable_sort_file_cache = 1
innodb_lock_wait_timeout = 50
innodb_lru_scan_depth = 1024
innodb_max_dirty_pages_pct = 90
innodb_max_dirty_pages_pct_lwm = 10
innodb_old_blocks_pct = 37
innodb_old_blocks_time = 1000
innodb_open_files = 4000
innodb_print_all_deadlocks = 1
innodb_purge_batch_size = 300
innodb_purge_threads = 8
innodb_stats_auto_recalc = 1
innodb_stats_method = nulls_equal
innodb_stats_on_metadata = 0
innodb_stats_persistent = 1
innodb_stats_persistent_sample_pages = 20
innodb_strict_mode = 1

# Query cache settings
query_cache_type = 0
query_cache_size = 0

# Connection settings
max_connections = 500
thread_cache_size = 128

# Memory settings
tmp_table_size = 64M
max_heap_table_size = 64M 
